"use strict";(self.webpackChunkroot=self.webpackChunkroot||[]).push([[648],{92648:function(ye,U,w){w.r(U),w.d(U,{QueryForm:function(){return de},QueryList:function(){return re},QueryTable:function(){return ve},QueryToolbar:function(){return Ce},Registry:function(){return o},default:function(){return ge},openDrawer:function(){return ee},openModal:function(){return _}});var t=w(62435),z=function(){function l(){this.containers={},this.ctrls={}}return l.prototype.addCtrl=function(e,r){this.ctrls[e]=r},l.prototype.addContainer=function(e,r){this.containers[e]=r},l.prototype.getCtrl=function(e){return this.ctrls[e]},l.prototype.getContainer=function(e){return this.containers[e]},l.DEFAULT_KEY="default",l}(),G=new z,Y=function(e){var r=e["x-component"];return t.createElement("div",{className:"dyn-form-ctrl-placeholder"},"\u672A\u5B9E\u73B0\u7684\u7EC4\u4EF6 \u5728\u5B57\u6BB5 ",r)},O=function(e){return t.createElement("div",{className:"dyn-form-container-placeholder"},e.children)};G.addCtrl(z.DEFAULT_KEY,Y),G.addContainer(z.DEFAULT_KEY,O);var o=G,Ee=function(){function l(e){this.registries=e.concat(G).filter(Boolean)}return l.prototype.getCtrl=function(e,r){r===void 0&&(r=!1);var a;if(e)for(var u=0,i=this.registries;u<i.length;u++){var f=i[u];if(a=f.getCtrl(e),a)break}return a||(r?this.getCtrl(z.DEFAULT_KEY):void 0)},l.prototype.getContainer=function(e,r){r===void 0&&(r=!1);var a;if(e)for(var u=0,i=this.registries;u<i.length;u++){var f=i[u];if(a=f.getContainer(e),a)break}return a||(r?this.getContainer(z.DEFAULT_KEY):void 0)},l}(),c=w(70655),J=w(99619),N=w(27420),n=w(71822),M={total:0,list:[]},L=t.createContext({query:function(e){return Promise.resolve(M)},refresh:function(){return Promise.resolve(M)},data:M,pageNum:1,pageSize:10,selectedRowKeys:[],handleSetSelectedRowKeys:function(){}});L.displayName="queryList";var Q=t.createContext({form:null});o.addCtrl("FormLayout",n.lt),o.addCtrl("FormItem",n.xJ),o.addCtrl("FormGrid",n.T5),o.addCtrl("FormButtonGroup",n.d5),o.addCtrl("Space",n.T),o.addCtrl("Submit",n.k4),o.addCtrl("Reset",n.AG),o.addCtrl("Input",n.II),o.addCtrl("Password",n.ro),o.addCtrl("Select",n.Ph),o.addCtrl("TreeSelect",n.mP),o.addCtrl("DatePicker",n.Mt),o.addCtrl("TimePicker",n.jI),o.addCtrl("NumberPicker",n.Ye),o.addCtrl("Transfer",n.FE),o.addCtrl("Cascader",n.vT),o.addCtrl("Checkbox",n.XZ),o.addCtrl("Radio",n.Y8),o.addCtrl("Upload",n.gq),o.addCtrl("Switch",n.rs),o.addCtrl("ArrayCards",n.uE),o.addCtrl("ArrayItems",n.sz),o.addCtrl("ArrayTable",n.hf),o.addCtrl("ArrayTabs",n.nN),o.addCtrl("FormCollapse",n.ox),o.addCtrl("FormStep",n.pl),o.addCtrl("FormTab",n.KE),o.addCtrl("FormDialog",n.D_),o.addCtrl("FormDrawer",n._8),o.addCtrl("Editable",n.CX),o.addCtrl("PreviewText",n.c8);var j=o,I=function(e){return Object.values((e==null?void 0:e.properties)||{}).map(function(r){return r["x-decorator"]?[r["x-decorator"],r["x-component"]]:r["x-component"]}).flat().reduce(function(r,a){return r[a]=j.getCtrl(a),r},{})},q={layout:"horizontal"},H=10,Z={title:"\u5F39\u7A97",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"},X={title:"\u62BD\u5C49"},W=function(e){var r=e.schema,a=e.formConfig,u=a===void 0?{}:a,i=e.children,f=e.scope,p=e.initialValues,d=(0,t.useMemo)(function(){return(0,J.Np)({validateFirst:!0})},[]);(0,t.useEffect)(function(){p&&d.setInitialValues(p)},[p]);var g=(0,t.useMemo)(function(){if(!r)return null;var C=I(r),s=(0,N.cA)({components:C});return t.createElement(n.lt,(0,c.pi)({},u),t.createElement(s,{schema:r,scope:f}))},[r,f]);return t.createElement(Q.Provider,{value:{form:d}},t.createElement(N.RV,{form:d},g,i))},$=W,_=function(e){var r=e.title,a=e.schema,u=e.formConfig,i=u===void 0?{}:u,f=e.initialValues,p=f===void 0?{}:f,d=e.onConfirm,g=e.onCancel,C=I(a),s=(0,N.cA)({components:C}),S=(0,c.pi)((0,c.pi)({},Z),typeof r=="string"?{title:r}:r),y=(0,n.D_)(S,function(){return t.createElement(n.lt,(0,c.pi)({},i),t.createElement(s,{schema:a}))});y.forOpen(function(m,v){v({initialValues:p})}).forConfirm(function(m,v){var b=m.getState().values;d(b).then(function(){return v(m)})}).forCancel(function(m,v){g&&g(),v(m)}).open()},ee=function(e){var r=e.title,a=e.schema,u=e.formConfig,i=u===void 0?{}:u,f=e.initialValues,p=f===void 0?{}:f,d=e.onConfirm,g=e.onCancel,C=I(a),s=(0,N.cA)({components:C}),S=(0,c.pi)((0,c.pi)({},X),typeof r=="string"?{title:r}:r),y=(0,n._8)(S,function(){var m=typeof d=="function";return t.createElement(n.lt,(0,c.pi)({},i),t.createElement(s,{schema:a}),m?t.createElement(n._8.Extra,null,t.createElement(n.d5,{align:"right"},t.createElement(n.AG,{onClick:function(){return y.close()}},"\u53D6\u6D88"),t.createElement(n.k4,{onSubmit:function(b){return d(b)}},"\u63D0\u4EA4"))):null)});y.open({initialValues:p})},te=function(e){var r=e.service,a=e.pageSize,u=a===void 0?H:a,i=e.children,f=(0,t.useContext)(Q).form,p=(0,t.useState)({list:[],total:0}),d=p[0],g=p[1],C=(0,t.useState)({pageNum:1,pageSize:u}),s=C[0],S=C[1],y=(0,t.useState)([]),m=y[0],v=y[1],b=function(E){return(0,c.mG)(void 0,void 0,void 0,function(){var h,x;return(0,c.Jh)(this,function(V){switch(V.label){case 0:return h=(0,c.pi)({pageNum:1,pageSize:u},E),[4,r(h)];case 1:return x=V.sent(),S({pageNum:h.pageNum,pageSize:h.pageSize}),g(x),[2,x]}})})},D=(0,t.useCallback)(function(){return(0,c.mG)(void 0,void 0,void 0,function(){var R,E,h;return(0,c.Jh)(this,function(x){switch(x.label){case 0:return R=f.getState().values,E=(0,c.pi)((0,c.pi)({},R),{pageNum:s.pageNum,pageSize:s.pageSize}),[4,r(E)];case 1:return h=x.sent(),g(h),[2,h]}})})},[f,r,s]),K=(0,t.useCallback)(function(R){v(R)},[]);return t.createElement(L.Provider,{value:{query:function(E){return b(E)},data:d,pageNum:s.pageNum,pageSize:s.pageSize,refresh:D,selectedRowKeys:m,handleSetSelectedRowKeys:K}},t.createElement("div",null,typeof i=="function"?i({refresh:D}):i))},re=te,ne=w(18446),ae=w.n(ne),oe=function(e,r){return ae()(e,r)},ie=function(e){var r=(0,t.useRef)(),a=(0,t.useRef)(0);return(e===void 0||!oe(e,r.current))&&(r.current=e,a.current+=1),a.current},le=ie,ue=function(e,r){r===void 0&&(r={});var a=(0,t.useReducer)(function(s){return s+1},0),u=a[1],i=(0,t.useMemo)(function(){var s={maxColumns:4,maxWidth:240,maxRows:e,shouldVisible:function(m,v){return m.index===v.childSize-1||v.maxRows===1/0?!0:m.shadowRow<e+1}},S=Object.assign(s,r);return n.T5.createFormGrid(S)},[le(r)]),f=i.maxRows===1/0,p=i.shadowRows,d=i.fullnessLastColumn?i.shadowRows-1:i.shadowRows,g=function(){i.maxRows===1/0?i.maxRows=e:i.maxRows=1/0,u()},C=function(){return p<e+1?"incomplete-wrap":d>e?"collapsible":"complete-wrap"};return{grid:i,expanded:f,toggle:g,type:C()}},se=ue,ce=function(e){var r=e.schema,a=e.scope,u=a===void 0?{}:a,i=e.formConfig,f=i===void 0?q:i,p=e.gridConfig,d=p===void 0?{minColumns:4}:p,g=(0,t.useContext)(Q).form,C=(0,t.useContext)(L).query,s=se(2,d),S=s.grid,y=s.expanded,m=s.toggle,v=s.type,b=function(h){C(h)},D=I(r),K=(0,N.cA)({components:D,scope:u}),R=(0,t.useCallback)(function(){var E=function(){return t.createElement(t.Fragment,null,t.createElement(n.k4,null,"\u67E5\u8BE2"),t.createElement(n.AG,null,"\u91CD\u7F6E"))};return v==="incomplete-wrap"?t.createElement(n.d5.FormItem,null,t.createElement(n.d5,null,E())):v==="collapsible"?t.createElement(t.Fragment,null,t.createElement(n.d5,null,E()),t.createElement(n.d5,{align:"right"},t.createElement("a",{onClick:function(x){x.preventDefault(),m()}},y?"\u6536\u8D77":"\u5C55\u5F00"))):t.createElement(n.d5,{align:"right",style:{display:"flex",width:"100%"}},E())},[v,y,m]);return t.createElement(n.l0,(0,c.pi)({form:g},f,{onAutoSubmit:b}),t.createElement(n.T5,{grid:S},t.createElement(K,{schema:r}),t.createElement(n.T5.GridColumn,{gridSpan:-1,style:{display:"flex",justifyContent:"space-between",marginBottom:"22px"}},R())))},de=ce,fe=w(46376),Se=w(37285),me=function(e){var r=e.columns,a=e.mode,u=e.primaryKey,i=u===void 0?"key":u,f=(0,c._T)(e,["columns","mode","primaryKey"]),p=(0,t.useContext)(Q).form,d=(0,t.useContext)(L),g=d.query,C=d.data,s=d.pageNum,S=d.pageSize,y=d.refresh,m=d.selectedRowKeys,v=d.handleSetSelectedRowKeys,b=(0,t.useState)(!1),D=b[0],K=b[1],R=function(T,F){return(0,c.mG)(void 0,void 0,void 0,function(){var A,k;return(0,c.Jh)(this,function(P){switch(P.label){case 0:A=p.getState().values,k=(0,c.pi)({pageNum:T,pageSize:F},A),P.label=1;case 1:return P.trys.push([1,,3,4]),K(!0),[4,g(k)];case 2:return P.sent(),[3,4];case 3:return K(!1),[7];case 4:return[2]}})})};(0,t.useEffect)(function(){R(s,S)},[]);var E={current:s,pageSize:S,showQuickJumper:!0,showTotal:function(T,F){return"\u5171".concat(T,"\u6761")},total:C.total,onChange:function(T,F){R(T,F)}},h=function(){return{type:a,selectedRowKeys:m,onChange:function(F){v(F)}}},x=function(T){return{onClick:function(){var A=T[i],k=m,P=m.indexOf(A);P==-1?k=(0,c.ev)((0,c.ev)([],m,!0),[A],!1):k=m.filter(function(he){return he!==A}),v(k)}}},V=r({refresh:y});return t.createElement(fe.Z,(0,c.pi)({columns:V,dataSource:C.list,loading:D,pagination:E,rowSelection:a?h():null,onRow:a?x:null},f))},ve=me;function pe(l){var e=l.children,r=(0,t.useContext)(L),a=r.refresh,u=r.selectedRowKeys;return t.createElement("div",null,typeof e=="function"?e({refresh:a,selectedRowKeys:u}):e)}var Ce=pe,ge=$}}]);
