"use strict";(self.webpackChunkroot=self.webpackChunkroot||[]).push([[799],{76799:function(Ae,O,S){S.r(O),S.d(O,{QueryForm:function(){return Se},QueryList:function(){return fe},QueryTable:function(){return De},QueryToolbar:function(){return xe},Registry:function(){return u},default:function(){return Te},openDrawer:function(){return ce},openModal:function(){return se}});var r=S(62435),z=function(){function i(){this.containers={},this.ctrls={}}return i.prototype.addCtrl=function(e,t){this.ctrls[e]=t},i.prototype.addContainer=function(e,t){this.containers[e]=t},i.prototype.getCtrl=function(e){return this.ctrls[e]},i.prototype.getContainer=function(e){return this.containers[e]},i.DEFAULT_KEY="default",i}(),L=new z,j=function(e){var t=e["x-component"];return r.createElement("div",{className:"dyn-form-ctrl-placeholder"},"\u672A\u5B9E\u73B0\u7684\u7EC4\u4EF6 \u5728\u5B57\u6BB5 ",t)},H=function(e){return r.createElement("div",{className:"dyn-form-container-placeholder"},e.children)};L.addCtrl(z.DEFAULT_KEY,j),L.addContainer(z.DEFAULT_KEY,H);var u=L,Ke=function(){function i(e){this.registries=e.concat(L).filter(Boolean)}return i.prototype.getCtrl=function(e,t){t===void 0&&(t=!1);var a;if(e)for(var l=0,o=this.registries;l<o.length;l++){var s=o[l];if(a=s.getCtrl(e),a)break}return a||(t?this.getCtrl(z.DEFAULT_KEY):void 0)},i.prototype.getContainer=function(e,t){t===void 0&&(t=!1);var a;if(e)for(var l=0,o=this.registries;l<o.length;l++){var s=o[l];if(a=s.getContainer(e),a)break}return a||(t?this.getContainer(z.DEFAULT_KEY):void 0)},i}(),f=S(70655),J=S(99619),A=S(27420),n=S(71822),B={total:0,list:[]},N=r.createContext({query:function(e){return Promise.resolve(B)},refresh:function(){return Promise.resolve(B)},data:B,pageNum:1,pageSize:10,selectedRowKeys:[],handleSetSelectedRowKeys:function(){}});N.displayName="queryList";var M=r.createContext({form:null}),Z=S(87521),Pe=S(89295),W=S(30381),V=S.n(W),X=function(e,t){return Array.isArray(e)?e.map(function(a){return V()(a,t)}):e&&V()(e,t)},$=function(e,t){var a=function(o,s,v){v===void 0&&(v=0);var d=/^(?:[01]\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/,m=s;return Array.isArray(s)&&(m=s[v]),d.test(o)?V()(o,m).format(m):V()(o).format(m)};return Array.isArray(e)?e.map(function(l,o){return a(l,t,o)}):e&&a(e,t)},q=Z.Z.RangePicker,U=function(e){},_=function(e){var t=e.deadline,a=e.interval,l=e.value,o=e.onChange,s=o===void 0?U:o,v=(0,f._T)(e,["deadline","interval","value","onChange"]),d=(0,r.useState)(null),m=d[0],g=d[1],c=(0,r.useState)(function(){return l}),D=c[0],y=c[1];(0,r.useEffect)(function(){y(l)},[l]);var p=function(h){var R=h&&h>t;if(!m)return t?R:!1;if(a){var w=m[0]&&h.diff(m[0],"days")>a,E=m[1]&&m[1].diff(h,"days")>a;return!!E||!!w||(t?R:!1)}return t?R:!1},C=function(h){g(h?[null,null]:null)},b=function(h){return y(h),typeof s=="function"?s(h):U(h)};return r.createElement(q,(0,f.pi)({value:m||D,disabledDate:p,onCalendarChange:function(h){return g(h)},onChange:b,onOpenChange:C},v))},ee=(0,A.$j)(_,(0,A.jM)(function(i){var e=function(o){return o.showTime?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"},t=i.onChange,a=i.format||e(i);return(0,f.pi)((0,f.pi)({},i),{format:i.format,value:X(i.value,a),onChange:function(o){t&&t($(o,a))}})})),te=ee;u.addCtrl("FormLayout",n.lt),u.addCtrl("FormItem",n.xJ),u.addCtrl("FormGrid",n.T5),u.addCtrl("Space",n.T),u.addCtrl("Submit",n.k4),u.addCtrl("Reset",n.AG),u.addCtrl("Input",n.II),u.addCtrl("Password",n.ro),u.addCtrl("Select",n.Ph),u.addCtrl("TreeSelect",n.mP),u.addCtrl("DatePicker",n.Mt),u.addCtrl("TimePicker",n.jI),u.addCtrl("NumberPicker",n.Ye),u.addCtrl("Transfer",n.FE),u.addCtrl("Cascader",n.vT),u.addCtrl("Checkbox",n.XZ),u.addCtrl("Radio",n.Y8),u.addCtrl("Upload",n.gq),u.addCtrl("Switch",n.rs),u.addCtrl("ArrayCards",n.uE),u.addCtrl("ArrayItems",n.sz),u.addCtrl("ArrayTable",n.hf),u.addCtrl("ArrayTabs",n.nN),u.addCtrl("FormCollapse",n.ox),u.addCtrl("FormStep",n.pl),u.addCtrl("FormTab",n.KE),u.addCtrl("FormDialog",n.D_),u.addCtrl("FormDrawer",n._8),u.addCtrl("Editable",n.CX),u.addCtrl("PreviewText",n.c8),u.addCtrl("RangePickerWithDisabledDate",te);var re=u,G=function(e){return Object.values((e==null?void 0:e.properties)||{}).map(function(t){return t["x-decorator"]?[t["x-decorator"],t["x-component"]]:t["x-component"]}).flat().reduce(function(t,a){return t[a]=re.getCtrl(a),t},{})},ke=function(e){return typeof e=="function"},ne={layout:"horizontal"},ae=10,oe={title:"\u5F39\u7A97",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"},ie={title:"\u62BD\u5C49"},le=function(e){var t=e.schema,a=e.formConfig,l=a===void 0?{}:a,o=e.children,s=e.scope,v=e.initialValues,d=(0,r.useMemo)(function(){return(0,J.Np)({validateFirst:!0})},[]);(0,r.useEffect)(function(){v&&d.setInitialValues(v)},[v]);var m=(0,r.useMemo)(function(){if(!t)return null;var g=G(t),c=(0,A.cA)({components:g});return r.createElement(n.lt,(0,f.pi)({},l),r.createElement(c,{schema:t,scope:s}))},[t,s]);return r.createElement(M.Provider,{value:{form:d}},r.createElement(A.RV,{form:d},m,o))},ue=le,se=function(e){var t=e.title,a=e.schema,l=e.formConfig,o=l===void 0?{}:l,s=e.initialValues,v=s===void 0?{}:s,d=e.onConfirm,m=e.onCancel,g=G(a),c=(0,A.cA)({components:g}),D=(0,f.pi)((0,f.pi)({},oe),typeof t=="string"?{title:t}:t),y=(0,n.D_)(D,function(){return r.createElement(n.lt,(0,f.pi)({},o),r.createElement(c,{schema:a}))});y.forOpen(function(p,C){C({initialValues:v})}).forConfirm(function(p,C){var b=p.getState().values;d(b).then(function(){return C(p)})}).forCancel(function(p,C){m&&m(),C(p)}).open()},ce=function(e){var t=e.title,a=e.schema,l=e.formConfig,o=l===void 0?{}:l,s=e.initialValues,v=s===void 0?{}:s,d=e.onConfirm,m=e.onCancel,g=G(a),c=(0,A.cA)({components:g}),D=(0,f.pi)((0,f.pi)({},ie),typeof t=="string"?{title:t}:t),y=(0,n._8)(D,function(){var p=typeof d=="function";return r.createElement(n.lt,(0,f.pi)({},o),r.createElement(c,{schema:a}),p?r.createElement(n._8.Extra,null,r.createElement(n.d5,{align:"right"},r.createElement(n.AG,{onClick:function(){return y.close()}},"\u53D6\u6D88"),r.createElement(n.k4,{onSubmit:function(b){return d(b)}},"\u63D0\u4EA4"))):null)});y.open({initialValues:v})},de=function(e){var t=e.service,a=e.pageSize,l=a===void 0?ae:a,o=e.children,s=(0,r.useContext)(M).form,v=(0,r.useState)({list:[],total:0}),d=v[0],m=v[1],g=(0,r.useState)({pageNum:1,pageSize:l}),c=g[0],D=g[1],y=(0,r.useState)([]),p=y[0],C=y[1],b=function(w){return(0,f.mG)(void 0,void 0,void 0,function(){var E,T;return(0,f.Jh)(this,function(Q){switch(Q.label){case 0:return E=(0,f.pi)({pageNum:1,pageSize:l},w),[4,t(E)];case 1:return T=Q.sent(),D({pageNum:E.pageNum,pageSize:E.pageSize}),m(T),[2,T]}})})},x=(0,r.useCallback)(function(){return(0,f.mG)(void 0,void 0,void 0,function(){var R,w,E;return(0,f.Jh)(this,function(T){switch(T.label){case 0:return R=s.getState().values,w=(0,f.pi)((0,f.pi)({},R),{pageNum:c.pageNum,pageSize:c.pageSize}),[4,t(w)];case 1:return E=T.sent(),m(E),[2,E]}})})},[s,t,c]),h=(0,r.useCallback)(function(R){C(R)},[]);return r.createElement(N.Provider,{value:{query:function(w){return b(w)},data:d,pageNum:c.pageNum,pageSize:c.pageSize,refresh:x,selectedRowKeys:p,handleSetSelectedRowKeys:h}},r.createElement("div",null,typeof o=="function"?o({refresh:x}):o))},fe=de,me=S(18446),ve=S.n(me),pe=function(e,t){return ve()(e,t)},Ce=function(e){var t=(0,r.useRef)(),a=(0,r.useRef)(0);return(e===void 0||!pe(e,t.current))&&(t.current=e,a.current+=1),a.current},ge=Ce,he=function(e,t){t===void 0&&(t={});var a=(0,r.useReducer)(function(c){return c+1},0),l=a[1],o=(0,r.useMemo)(function(){var c={maxColumns:4,maxWidth:240,maxRows:e,shouldVisible:function(p,C){return p.index===C.childSize-1||C.maxRows===1/0?!0:p.shadowRow<e+1}},D=Object.assign(c,t);return n.T5.createFormGrid(D)},[ge(t)]),s=o.maxRows===1/0,v=o.shadowRows,d=o.fullnessLastColumn?o.shadowRows-1:o.shadowRows,m=function(){o.maxRows===1/0?o.maxRows=e:o.maxRows=1/0,l()},g=function(){return v<e+1?"incomplete-wrap":d>e?"collapsible":"complete-wrap"};return{grid:o,expanded:s,toggle:m,type:g()}},ye=he,Ee=function(e){var t=e.schema,a=e.scope,l=a===void 0?{}:a,o=e.formConfig,s=o===void 0?ne:o,v=e.gridConfig,d=v===void 0?{minColumns:4}:v,m=(0,r.useContext)(M).form,g=(0,r.useContext)(N).query,c=ye(2,d),D=c.grid,y=c.expanded,p=c.toggle,C=c.type,b=function(E){g(E)},x=G(t),h=(0,A.cA)({components:x,scope:l}),R=(0,r.useCallback)(function(){var w=function(){return r.createElement(r.Fragment,null,r.createElement(n.k4,null,"\u67E5\u8BE2"),r.createElement(n.AG,null,"\u91CD\u7F6E"))};return C==="incomplete-wrap"?r.createElement(n.d5.FormItem,null,r.createElement(n.d5,null,w())):C==="collapsible"?r.createElement(r.Fragment,null,r.createElement(n.d5,null,w()),r.createElement(n.d5,{align:"right"},r.createElement("a",{onClick:function(T){T.preventDefault(),p()}},y?"\u6536\u8D77":"\u5C55\u5F00"))):r.createElement(n.d5,{align:"right",style:{display:"flex",width:"100%"}},w())},[C,y,p]);return r.createElement(n.l0,(0,f.pi)({form:m},s,{onAutoSubmit:b}),r.createElement(n.T5,{grid:D},r.createElement(h,{schema:t}),r.createElement(n.T5.GridColumn,{gridSpan:-1,style:{display:"flex",justifyContent:"space-between",marginBottom:"22px"}},R())))},Se=Ee,Re=S(46376),Ie=S(10373),we=function(e){var t=e.columns,a=e.mode,l=e.primaryKey,o=l===void 0?"key":l,s=(0,f._T)(e,["columns","mode","primaryKey"]),v=(0,r.useContext)(M).form,d=(0,r.useContext)(N),m=d.query,g=d.data,c=d.pageNum,D=d.pageSize,y=d.refresh,p=d.selectedRowKeys,C=d.handleSetSelectedRowKeys,b=(0,r.useState)(!1),x=b[0],h=b[1],R=function(F,K){return(0,f.mG)(void 0,void 0,void 0,function(){var P,k;return(0,f.Jh)(this,function(I){switch(I.label){case 0:P=v.getState().values,k=(0,f.pi)({pageNum:F,pageSize:K},P),I.label=1;case 1:return I.trys.push([1,,3,4]),h(!0),[4,m(k)];case 2:return I.sent(),[3,4];case 3:return h(!1),[7];case 4:return[2]}})})};(0,r.useEffect)(function(){R(c,D)},[]);var w={current:c,pageSize:D,showQuickJumper:!0,showTotal:function(F,K){return"\u5171".concat(F,"\u6761")},total:g.total,onChange:function(F,K){R(F,K)}},E=function(){return{type:a,selectedRowKeys:p,onChange:function(K){C(K)}}},T=function(F){return{onClick:function(){var P=F[o],k=p,I=p.indexOf(P);I==-1?k=(0,f.ev)((0,f.ev)([],p,!0),[P],!1):k=p.filter(function(Fe){return Fe!==P}),C(k)}}},Q=t({refresh:y});return r.createElement(Re.Z,(0,f.pi)({columns:Q,dataSource:g.list,loading:x,pagination:w,rowSelection:a?E():null,onRow:a?T:null},s))},De=we;function be(i){var e=i.children,t=(0,r.useContext)(N),a=t.refresh,l=t.selectedRowKeys;return r.createElement("div",null,typeof e=="function"?e({refresh:a,selectedRowKeys:l}):e)}var xe=be,Te=ue}}]);
