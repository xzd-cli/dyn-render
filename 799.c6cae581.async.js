"use strict";(self.webpackChunkroot=self.webpackChunkroot||[]).push([[799],{76799:function(Ie,B,S){S.r(B),S.d(B,{QueryForm:function(){return be},QueryList:function(){return pe},QueryTable:function(){return Fe},QueryToolbar:function(){return Ke},Registry:function(){return u},default:function(){return Pe},openDrawer:function(){return ve},openModal:function(){return me}});var r=S(62435),N=function(){function i(){this.containers={},this.ctrls={}}return i.prototype.addCtrl=function(e,t){this.ctrls[e]=t},i.prototype.addContainer=function(e,t){this.containers[e]=t},i.prototype.getCtrl=function(e){return this.ctrls[e]},i.prototype.getContainer=function(e){return this.containers[e]},i.DEFAULT_KEY="default",i}(),L=new N,H=function(e){var t=e["x-component"];return r.createElement("div",{className:"dyn-form-ctrl-placeholder"},"\u672A\u5B9E\u73B0\u7684\u7EC4\u4EF6 \u5728\u5B57\u6BB5 ",t)},J=function(e){return r.createElement("div",{className:"dyn-form-container-placeholder"},e.children)};L.addCtrl(N.DEFAULT_KEY,H),L.addContainer(N.DEFAULT_KEY,J);var u=L,Ve=function(){function i(e){this.registries=e.concat(L).filter(Boolean)}return i.prototype.getCtrl=function(e,t){t===void 0&&(t=!1);var a;if(e)for(var l=0,o=this.registries;l<o.length;l++){var c=o[l];if(a=c.getCtrl(e),a)break}return a||(t?this.getCtrl(N.DEFAULT_KEY):void 0)},i.prototype.getContainer=function(e,t){t===void 0&&(t=!1);var a;if(e)for(var l=0,o=this.registries;l<o.length;l++){var c=o[l];if(a=c.getContainer(e),a)break}return a||(t?this.getContainer(N.DEFAULT_KEY):void 0)},i}(),f=S(70655),Z=S(85667),U=S(99619),k=S(27420),n=S(71822),W=S(23279),X=S.n(W),O={total:0,list:[]},G=r.createContext({query:function(e){return Promise.resolve(O)},refresh:function(){return Promise.resolve(O)},data:O,pageNum:1,pageSize:10,selectedRowKeys:[],handleSetSelectedRowKeys:function(){}});G.displayName="queryList";var M=r.createContext({form:null,responseValue:null,trigger:""}),$=S(87521),ze=S(89295),q=S(30381),Q=S.n(q),_=function(e,t){return Array.isArray(e)?e.map(function(a){return Q()(a,t)}):e&&Q()(e,t)},ee=function(e,t){var a=function(o,c,g){g===void 0&&(g=0);var m=/^(?:[01]\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/,s=c;return Array.isArray(c)&&(s=c[g]),m.test(o)?Q()(o,s).format(s):Q()(o).format(s)};return Array.isArray(e)?e.map(function(l,o){return a(l,t,o)}):e&&a(e,t)},te=$.Z.RangePicker,j=function(e){},re=function(e){var t=e.deadline,a=e.interval,l=e.value,o=e.onChange,c=o===void 0?j:o,g=(0,f._T)(e,["deadline","interval","value","onChange"]),m=(0,r.useState)(null),s=m[0],C=m[1],d=(0,r.useState)(function(){return l}),R=d[0],y=d[1];(0,r.useEffect)(function(){y(l)},[l]);var v=function(h){var w=h&&h>t;if(!s)return t?w:!1;if(a){var D=s[0]&&h.diff(s[0],"days")>a,b=s[1]&&s[1].diff(h,"days")>a;return!!b||!!D||(t?w:!1)}return t?w:!1},p=function(h){C(h?[null,null]:null)},E=function(h){return y(h),typeof c=="function"?c(h):j(h)};return r.createElement(te,(0,f.pi)({value:s||R,disabledDate:v,onCalendarChange:function(h){return C(h)},onChange:E,onOpenChange:p},g))},ne=(0,k.$j)(re,(0,k.jM)(function(i){var e=function(o){return o.showTime?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"},t=i.onChange,a=i.format||e(i);return(0,f.pi)((0,f.pi)({},i),{format:i.format,value:_(i.value,a),onChange:function(o){t&&t(ee(o,a))}})})),ae=ne;u.addCtrl("FormLayout",n.lt),u.addCtrl("FormItem",n.xJ),u.addCtrl("FormGrid",n.T5),u.addCtrl("Space",n.T),u.addCtrl("Submit",n.k4),u.addCtrl("Reset",n.AG),u.addCtrl("Input",n.II),u.addCtrl("Password",n.ro),u.addCtrl("Select",n.Ph),u.addCtrl("TreeSelect",n.mP),u.addCtrl("DatePicker",n.Mt),u.addCtrl("TimePicker",n.jI),u.addCtrl("NumberPicker",n.Ye),u.addCtrl("Transfer",n.FE),u.addCtrl("Cascader",n.vT),u.addCtrl("Checkbox",n.XZ),u.addCtrl("Radio",n.Y8),u.addCtrl("Upload",n.gq),u.addCtrl("Switch",n.rs),u.addCtrl("ArrayCards",n.uE),u.addCtrl("ArrayItems",n.sz),u.addCtrl("ArrayTable",n.hf),u.addCtrl("ArrayTabs",n.nN),u.addCtrl("FormCollapse",n.ox),u.addCtrl("FormStep",n.pl),u.addCtrl("FormTab",n.KE),u.addCtrl("FormDialog",n.D_),u.addCtrl("FormDrawer",n._8),u.addCtrl("Editable",n.CX),u.addCtrl("PreviewText",n.c8),u.addCtrl("RangePickerWithDisabledDate",ae);var oe=u,ie=function(e){switch(e){case"Input.TextArea":return"Input";case"Radio.Group":return"Radio";case"DatePicker.RangePicker":return"DatePicker";case"Checkbox.Group":return"Checkbox";default:return e}},Y=function(e){return Object.values((e==null?void 0:e.properties)||{}).map(function(t){return t["x-decorator"]?[t["x-decorator"],t["x-component"]]:t["x-component"]}).flat().reduce(function(t,a){var l=ie(a);return t[l]=oe.getCtrl(l),t},{})},Ne=function(e){return typeof e=="function"},le={layout:"horizontal"},ue=10,se={title:"\u5F39\u7A97",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"},ce={title:"\u62BD\u5C49"},de=function(e){var t=e.schema,a=e.formConfig,l=a===void 0?{}:a,o=e.children,c=e.scope,g=e.initialValues,m=e.trigger,s=m===void 0?"onSubmit":m,C=(0,r.useState)(null),d=C[0],R=C[1],y=(0,r.useMemo)(function(){return(0,U.Np)((0,f.pi)({validateFirst:!0},s==="onChange"?{effects:function(){(0,U.pO)(X()(function(E){R((0,Z.ZN)(E.values))},300))}}:null))},[s]);(0,r.useEffect)(function(){g&&y.setInitialValues(g)},[g]);var v=(0,r.useMemo)(function(){if(!t)return null;var p=Y(t),E=(0,k.cA)({components:p});return r.createElement(n.lt,(0,f.pi)({},l),r.createElement(E,{schema:t,scope:c}))},[t,c]);return console.log(d,"--responseValue--"),r.createElement(M.Provider,{value:{form:y,responseValue:d,trigger:s}},r.createElement(k.RV,{form:y},v,o))},fe=de,me=function(e){var t=e.title,a=e.schema,l=e.formConfig,o=l===void 0?{}:l,c=e.initialValues,g=c===void 0?{}:c,m=e.onConfirm,s=e.onCancel,C=Y(a),d=(0,k.cA)({components:C}),R=(0,f.pi)((0,f.pi)({},se),typeof t=="string"?{title:t}:t),y=(0,n.D_)(R,function(){return r.createElement(n.lt,(0,f.pi)({},o),r.createElement(d,{schema:a}))});y.forOpen(function(v,p){p({initialValues:g})}).forConfirm(function(v,p){var E=v.getState().values;m(E).then(function(){return p(v)})}).forCancel(function(v,p){s&&s(),p(v)}).open()},ve=function(e){var t=e.title,a=e.schema,l=e.formConfig,o=l===void 0?{}:l,c=e.initialValues,g=c===void 0?{}:c,m=e.onConfirm,s=e.onCancel,C=Y(a),d=(0,k.cA)({components:C}),R=(0,f.pi)((0,f.pi)({},ce),typeof t=="string"?{title:t}:t),y=(0,n._8)(R,function(){var v=typeof m=="function";return r.createElement(n.lt,(0,f.pi)({},o),r.createElement(d,{schema:a}),v?r.createElement(n._8.Extra,null,r.createElement(n.d5,{align:"right"},r.createElement(n.AG,{onClick:function(){return y.close()}},"\u53D6\u6D88"),r.createElement(n.k4,{onSubmit:function(E){return m(E)}},"\u63D0\u4EA4"))):null)});y.open({initialValues:g})},ge=function(e){var t=e.service,a=e.pageSize,l=a===void 0?ue:a,o=e.children,c=(0,r.useContext)(M).form,g=(0,r.useState)({list:[],total:0}),m=g[0],s=g[1],C=(0,r.useState)({pageNum:1,pageSize:l}),d=C[0],R=C[1],y=(0,r.useState)([]),v=y[0],p=y[1],E=function(D){return(0,f.mG)(void 0,void 0,void 0,function(){var b,F;return(0,f.Jh)(this,function(I){switch(I.label){case 0:return b=(0,f.pi)({pageNum:1,pageSize:l},D),[4,t(b)];case 1:return F=I.sent(),R({pageNum:b.pageNum,pageSize:b.pageSize}),s(F),[2,F]}})})},T=(0,r.useCallback)(function(){return(0,f.mG)(void 0,void 0,void 0,function(){var w,D,b;return(0,f.Jh)(this,function(F){switch(F.label){case 0:return w=c.getState().values,D=(0,f.pi)((0,f.pi)({},w),{pageNum:d.pageNum,pageSize:d.pageSize}),[4,t(D)];case 1:return b=F.sent(),s(b),[2,b]}})})},[c,t,d]),h=(0,r.useCallback)(function(w){p(w)},[]);return r.createElement(G.Provider,{value:{query:function(D){return E(D)},data:m,pageNum:d.pageNum,pageSize:d.pageSize,refresh:T,selectedRowKeys:v,handleSetSelectedRowKeys:h}},r.createElement("div",null,typeof o=="function"?o({refresh:T}):o))},pe=ge,Ce=S(18446),he=S.n(Ce),ye=function(e,t){return he()(e,t)},Ee=function(e){var t=(0,r.useRef)(),a=(0,r.useRef)(0);return(e===void 0||!ye(e,t.current))&&(t.current=e,a.current+=1),a.current},Se=Ee,Re=function(e,t){t===void 0&&(t={});var a=(0,r.useReducer)(function(d){return d+1},0),l=a[1],o=(0,r.useMemo)(function(){var d={maxColumns:4,maxWidth:240,maxRows:e,shouldVisible:function(v,p){return v.index===p.childSize-1||p.maxRows===1/0?!0:v.shadowRow<e+1}},R=Object.assign(d,t);return n.T5.createFormGrid(R)},[Se(t)]),c=o.maxRows===1/0,g=o.shadowRows,m=o.fullnessLastColumn?o.shadowRows-1:o.shadowRows,s=function(){o.maxRows===1/0?o.maxRows=e:o.maxRows=1/0,l()},C=function(){return g<e+1?"incomplete-wrap":m>e?"collapsible":"complete-wrap"};return{grid:o,expanded:c,toggle:s,type:C()}},we=Re,De=function(e){var t=e.schema,a=e.scope,l=a===void 0?{}:a,o=e.formConfig,c=o===void 0?le:o,g=e.gridConfig,m=g===void 0?{minColumns:4}:g,s=e.rows,C=s===void 0?2:s,d=(0,r.useContext)(M),R=d.form,y=d.trigger,v=d.responseValue,p=(0,r.useContext)(G).query,E=we(C,m),T=E.grid,h=E.expanded,w=E.toggle,D=E.type,b=y==="onChange";(0,r.useEffect)(function(){b&&v!==null&&D==="incomplete-wrap"&&p(v)},[v,b,D]);var F=function(K){p(K)},I=Y(t),V=(0,k.cA)({components:I,scope:l}),A=(0,r.useCallback)(function(){var x=function(){return r.createElement(r.Fragment,null,r.createElement(n.k4,null,"\u67E5\u8BE2"),r.createElement(n.AG,null,"\u91CD\u7F6E"))};return D==="incomplete-wrap"?r.createElement(n.d5.FormItem,null,r.createElement(n.d5,null,b?null:x())):D==="collapsible"?r.createElement(r.Fragment,null,r.createElement(n.d5,null,x()),r.createElement(n.d5,{align:"right"},r.createElement("a",{onClick:function(P){P.preventDefault(),w()}},h?"\u6536\u8D77":"\u5C55\u5F00"))):r.createElement(n.d5,{align:"right",style:{display:"flex",width:"100%"}},x())},[D,h,w]);return r.createElement(n.l0,(0,f.pi)({form:R},c,{onAutoSubmit:F}),r.createElement(n.T5,{grid:T},r.createElement(V,{schema:t}),r.createElement(n.T5.GridColumn,{gridSpan:-1,style:{display:"flex",justifyContent:"space-between",marginBottom:"22px"}},A())))},be=De,xe=S(46376),Ge=S(10373),Te=function(e){var t=e.columns,a=e.mode,l=e.primaryKey,o=l===void 0?"key":l,c=(0,f._T)(e,["columns","mode","primaryKey"]),g=(0,r.useContext)(M).form,m=(0,r.useContext)(G),s=m.query,C=m.data,d=m.pageNum,R=m.pageSize,y=m.refresh,v=m.selectedRowKeys,p=m.handleSetSelectedRowKeys,E=(0,r.useState)(!1),T=E[0],h=E[1],w=function(A,x){return(0,f.mG)(void 0,void 0,void 0,function(){var K,P;return(0,f.Jh)(this,function(z){switch(z.label){case 0:K=g.getState().values,P=(0,f.pi)({pageNum:A,pageSize:x},K),z.label=1;case 1:return z.trys.push([1,,3,4]),h(!0),[4,s(P)];case 2:return z.sent(),[3,4];case 3:return h(!1),[7];case 4:return[2]}})})};(0,r.useEffect)(function(){w(d,R)},[]);var D={current:d,pageSize:R,showQuickJumper:!0,showTotal:function(A,x){return"\u5171".concat(A,"\u6761")},total:C.total,onChange:function(A,x){w(A,x)}},b=function(){return{type:a,selectedRowKeys:v,onChange:function(x){p(x)}}},F=function(A){return{onClick:function(){var K=A[o],P=v,z=v.indexOf(K);z==-1?P=(0,f.ev)((0,f.ev)([],v,!0),[K],!1):P=v.filter(function(ke){return ke!==K}),p(P)}}},I=t({refresh:y});return r.createElement(xe.Z,(0,f.pi)({columns:I,dataSource:C.list,loading:T,pagination:D,rowSelection:a?b():null,onRow:a?F:null},c))},Fe=Te;function Ae(i){var e=i.children,t=(0,r.useContext)(G),a=t.refresh,l=t.selectedRowKeys;return r.createElement("div",null,typeof e=="function"?e({refresh:a,selectedRowKeys:l}):e)}var Ke=Ae,Pe=fe}}]);
